{"version":3,"sources":["colorpicker.js"],"names":["define","skylark","$","charMin","defaults","fillRGBFields","fillHSBFields","fillHexFields","setSelector","setHue","setCurrentColor","setNewColor","keyDown","change","blur","focus","downIncrement","moveIncrement","upIncrement","downHue","moveHue","upHue","downSelector","moveSelector","upSelector","enterSubmit","leaveSubmit","clickSubmit","show","hide","isChildOf","getViewport","fixHSB","fixRGB","fixHex","HexToHSB","RGBToHSB","HSBToRGB","HSBToHex","restoreOriginal","ColorPicker","eventName","onShow","onBeforeShow","onHide","onChange","onSubmit","color","livePreview","flat","hsb","cal","rgb","data","fields","eq","val","r","end","g","b","h","s","selector","css","selectorIndic","left","parseInt","top","hue","currentColor","newColor","ev","pressedKey","charCode","keyCode","this","parent","apply","col","parentNode","className","indexOf","value","get","removeClass","addClass","field","find","current","el","max","y","pageY","preview","document","bind","Math","min","unbind","offset","pos","pageX","origColor","viewPort","offsetHeight","t","l","w","target","parentEl","container","contains","compareDocumentPosition","prEl","m","compatMode","window","pageXOffset","documentElement","scrollLeft","body","pageYOffset","scrollTop","innerWidth","clientWidth","innerHeight","clientHeight","hex","len","length","o","i","push","join","substring","HexToRGB","delta","round","v","t1","t2","t3","toString","each","nr","init","opt","extend","undefined","options","id","random","attr","appendTo","position","display","showPicker","hidePicker","setColor","fn","ColorPickerHide","ColorPickerShow","ColorPickerSetColor"],"mappings":"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","file":"../colorpicker.js","sourcesContent":["define([\r\n\t\"skylark-langx/skylark\",\r\n\t\"skylark-jquery\"\r\n],function (skylark,$) {\r\n\tvar ColorPicker = function () {\r\n\t\tvar\r\n\t\t\tids = {},\r\n\t\t\tinAction,\r\n\t\t\tcharMin = 65,\r\n\t\t\tvisible,\r\n\t\t\ttpl = '<div class=\"colorpicker\"><div class=\"colorpicker_color\"><div><div></div></div></div><div class=\"colorpicker_hue\"><div></div></div><div class=\"colorpicker_new_color\"></div><div class=\"colorpicker_current_color\"></div><div class=\"colorpicker_hex\"><input type=\"text\" maxlength=\"6\" size=\"6\" /></div><div class=\"colorpicker_rgb_r colorpicker_field\"><input type=\"text\" maxlength=\"3\" size=\"3\" /><span></span></div><div class=\"colorpicker_rgb_g colorpicker_field\"><input type=\"text\" maxlength=\"3\" size=\"3\" /><span></span></div><div class=\"colorpicker_rgb_b colorpicker_field\"><input type=\"text\" maxlength=\"3\" size=\"3\" /><span></span></div><div class=\"colorpicker_hsb_h colorpicker_field\"><input type=\"text\" maxlength=\"3\" size=\"3\" /><span></span></div><div class=\"colorpicker_hsb_s colorpicker_field\"><input type=\"text\" maxlength=\"3\" size=\"3\" /><span></span></div><div class=\"colorpicker_hsb_b colorpicker_field\"><input type=\"text\" maxlength=\"3\" size=\"3\" /><span></span></div><div class=\"colorpicker_submit\"></div></div>',\r\n\t\t\tdefaults = {\r\n\t\t\t\teventName: 'click',\r\n\t\t\t\tonShow: function () {},\r\n\t\t\t\tonBeforeShow: function(){},\r\n\t\t\t\tonHide: function () {},\r\n\t\t\t\tonChange: function () {},\r\n\t\t\t\tonSubmit: function () {},\r\n\t\t\t\tcolor: 'ff0000',\r\n\t\t\t\tlivePreview: true,\r\n\t\t\t\tflat: false\r\n\t\t\t},\r\n\t\t\tfillRGBFields = function  (hsb, cal) {\r\n\t\t\t\tvar rgb = HSBToRGB(hsb);\r\n\t\t\t\t$(cal).data('colorpicker').fields\r\n\t\t\t\t\t.eq(1).val(rgb.r).end()\r\n\t\t\t\t\t.eq(2).val(rgb.g).end()\r\n\t\t\t\t\t.eq(3).val(rgb.b).end();\r\n\t\t\t},\r\n\t\t\tfillHSBFields = function  (hsb, cal) {\r\n\t\t\t\t$(cal).data('colorpicker').fields\r\n\t\t\t\t\t.eq(4).val(hsb.h).end()\r\n\t\t\t\t\t.eq(5).val(hsb.s).end()\r\n\t\t\t\t\t.eq(6).val(hsb.b).end();\r\n\t\t\t},\r\n\t\t\tfillHexFields = function (hsb, cal) {\r\n\t\t\t\t$(cal).data('colorpicker').fields\r\n\t\t\t\t\t.eq(0).val(HSBToHex(hsb)).end();\r\n\t\t\t},\r\n\t\t\tsetSelector = function (hsb, cal) {\r\n\t\t\t\t$(cal).data('colorpicker').selector.css('backgroundColor', '#' + HSBToHex({h: hsb.h, s: 100, b: 100}));\r\n\t\t\t\t$(cal).data('colorpicker').selectorIndic.css({\r\n\t\t\t\t\tleft: parseInt(150 * hsb.s/100, 10),\r\n\t\t\t\t\ttop: parseInt(150 * (100-hsb.b)/100, 10)\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tsetHue = function (hsb, cal) {\r\n\t\t\t\t$(cal).data('colorpicker').hue.css('top', parseInt(150 - 150 * hsb.h/360, 10));\r\n\t\t\t},\r\n\t\t\tsetCurrentColor = function (hsb, cal) {\r\n\t\t\t\t$(cal).data('colorpicker').currentColor.css('backgroundColor', '#' + HSBToHex(hsb));\r\n\t\t\t},\r\n\t\t\tsetNewColor = function (hsb, cal) {\r\n\t\t\t\t$(cal).data('colorpicker').newColor.css('backgroundColor', '#' + HSBToHex(hsb));\r\n\t\t\t},\r\n\t\t\tkeyDown = function (ev) {\r\n\t\t\t\tvar pressedKey = ev.charCode || ev.keyCode || -1;\r\n\t\t\t\tif ((pressedKey > charMin && pressedKey <= 90) || pressedKey == 32) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t\tvar cal = $(this).parent().parent();\r\n\t\t\t\tif (cal.data('colorpicker').livePreview === true) {\r\n\t\t\t\t\tchange.apply(this);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tchange = function (ev) {\r\n\t\t\t\tvar cal = $(this).parent().parent(), col;\r\n\t\t\t\tif (this.parentNode.className.indexOf('_hex') > 0) {\r\n\t\t\t\t\tcal.data('colorpicker').color = col = HexToHSB(fixHex(this.value));\r\n\t\t\t\t} else if (this.parentNode.className.indexOf('_hsb') > 0) {\r\n\t\t\t\t\tcal.data('colorpicker').color = col = fixHSB({\r\n\t\t\t\t\t\th: parseInt(cal.data('colorpicker').fields.eq(4).val(), 10),\r\n\t\t\t\t\t\ts: parseInt(cal.data('colorpicker').fields.eq(5).val(), 10),\r\n\t\t\t\t\t\tb: parseInt(cal.data('colorpicker').fields.eq(6).val(), 10)\r\n\t\t\t\t\t});\r\n\t\t\t\t} else {\r\n\t\t\t\t\tcal.data('colorpicker').color = col = RGBToHSB(fixRGB({\r\n\t\t\t\t\t\tr: parseInt(cal.data('colorpicker').fields.eq(1).val(), 10),\r\n\t\t\t\t\t\tg: parseInt(cal.data('colorpicker').fields.eq(2).val(), 10),\r\n\t\t\t\t\t\tb: parseInt(cal.data('colorpicker').fields.eq(3).val(), 10)\r\n\t\t\t\t\t}));\r\n\t\t\t\t}\r\n\t\t\t\tif (ev) {\r\n\t\t\t\t\tfillRGBFields(col, cal.get(0));\r\n\t\t\t\t\tfillHexFields(col, cal.get(0));\r\n\t\t\t\t\tfillHSBFields(col, cal.get(0));\r\n\t\t\t\t}\r\n\t\t\t\tsetSelector(col, cal.get(0));\r\n\t\t\t\tsetHue(col, cal.get(0));\r\n\t\t\t\tsetNewColor(col, cal.get(0));\r\n\t\t\t\tcal.data('colorpicker').onChange.apply(cal, [col, HSBToHex(col), HSBToRGB(col)]);\r\n\t\t\t},\r\n\t\t\tblur = function (ev) {\r\n\t\t\t\tvar cal = $(this).parent().parent();\r\n\t\t\t\tcal.data('colorpicker').fields.parent().removeClass('colorpicker_focus');\r\n\t\t\t},\r\n\t\t\tfocus = function () {\r\n\t\t\t\tcharMin = this.parentNode.className.indexOf('_hex') > 0 ? 70 : 65;\r\n\t\t\t\t$(this).parent().parent().data('colorpicker').fields.parent().removeClass('colorpicker_focus');\r\n\t\t\t\t$(this).parent().addClass('colorpicker_focus');\r\n\t\t\t},\r\n\t\t\tdownIncrement = function (ev) {\r\n\t\t\t\tvar field = $(this).parent().find('input').focus();\r\n\t\t\t\tvar current = {\r\n\t\t\t\t\tel: $(this).parent().addClass('colorpicker_slider'),\r\n\t\t\t\t\tmax: this.parentNode.className.indexOf('_hsb_h') > 0 ? 360 : (this.parentNode.className.indexOf('_hsb') > 0 ? 100 : 255),\r\n\t\t\t\t\ty: ev.pageY,\r\n\t\t\t\t\tfield: field,\r\n\t\t\t\t\tval: parseInt(field.val(), 10),\r\n\t\t\t\t\tpreview: $(this).parent().parent().data('colorpicker').livePreview\t\t\t\t\t\r\n\t\t\t\t};\r\n\t\t\t\t$(document).bind('mouseup', current, upIncrement);\r\n\t\t\t\t$(document).bind('mousemove', current, moveIncrement);\r\n\t\t\t},\r\n\t\t\tmoveIncrement = function (ev) {\r\n\t\t\t\tev.data.field.val(Math.max(0, Math.min(ev.data.max, parseInt(ev.data.val + ev.pageY - ev.data.y, 10))));\r\n\t\t\t\tif (ev.data.preview) {\r\n\t\t\t\t\tchange.apply(ev.data.field.get(0), [true]);\r\n\t\t\t\t}\r\n\t\t\t\treturn false;\r\n\t\t\t},\r\n\t\t\tupIncrement = function (ev) {\r\n\t\t\t\tchange.apply(ev.data.field.get(0), [true]);\r\n\t\t\t\tev.data.el.removeClass('colorpicker_slider').find('input').focus();\r\n\t\t\t\t$(document).unbind('mouseup', upIncrement);\r\n\t\t\t\t$(document).unbind('mousemove', moveIncrement);\r\n\t\t\t\treturn false;\r\n\t\t\t},\r\n\t\t\tdownHue = function (ev) {\r\n\t\t\t\tvar current = {\r\n\t\t\t\t\tcal: $(this).parent(),\r\n\t\t\t\t\ty: $(this).offset().top\r\n\t\t\t\t};\r\n\t\t\t\tcurrent.preview = current.cal.data('colorpicker').livePreview;\r\n\t\t\t\t$(document).bind('mouseup', current, upHue);\r\n\t\t\t\t$(document).bind('mousemove', current, moveHue);\r\n\t\t\t},\r\n\t\t\tmoveHue = function (ev) {\r\n\t\t\t\tchange.apply(\r\n\t\t\t\t\tev.data.cal.data('colorpicker')\r\n\t\t\t\t\t\t.fields\r\n\t\t\t\t\t\t.eq(4)\r\n\t\t\t\t\t\t.val(parseInt(360*(150 - Math.max(0,Math.min(150,(ev.pageY - ev.data.y))))/150, 10))\r\n\t\t\t\t\t\t.get(0),\r\n\t\t\t\t\t[ev.data.preview]\r\n\t\t\t\t);\r\n\t\t\t\treturn false;\r\n\t\t\t},\r\n\t\t\tupHue = function (ev) {\r\n\t\t\t\tfillRGBFields(ev.data.cal.data('colorpicker').color, ev.data.cal.get(0));\r\n\t\t\t\tfillHexFields(ev.data.cal.data('colorpicker').color, ev.data.cal.get(0));\r\n\t\t\t\t$(document).unbind('mouseup', upHue);\r\n\t\t\t\t$(document).unbind('mousemove', moveHue);\r\n\t\t\t\treturn false;\r\n\t\t\t},\r\n\t\t\tdownSelector = function (ev) {\r\n\t\t\t\tvar current = {\r\n\t\t\t\t\tcal: $(this).parent(),\r\n\t\t\t\t\tpos: $(this).offset()\r\n\t\t\t\t};\r\n\t\t\t\tcurrent.preview = current.cal.data('colorpicker').livePreview;\r\n\t\t\t\t$(document).bind('mouseup', current, upSelector);\r\n\t\t\t\t$(document).bind('mousemove', current, moveSelector);\r\n\t\t\t},\r\n\t\t\tmoveSelector = function (ev) {\r\n\t\t\t\tchange.apply(\r\n\t\t\t\t\tev.data.cal.data('colorpicker')\r\n\t\t\t\t\t\t.fields\r\n\t\t\t\t\t\t.eq(6)\r\n\t\t\t\t\t\t.val(parseInt(100*(150 - Math.max(0,Math.min(150,(ev.pageY - ev.data.pos.top))))/150, 10))\r\n\t\t\t\t\t\t.end()\r\n\t\t\t\t\t\t.eq(5)\r\n\t\t\t\t\t\t.val(parseInt(100*(Math.max(0,Math.min(150,(ev.pageX - ev.data.pos.left))))/150, 10))\r\n\t\t\t\t\t\t.get(0),\r\n\t\t\t\t\t[ev.data.preview]\r\n\t\t\t\t);\r\n\t\t\t\treturn false;\r\n\t\t\t},\r\n\t\t\tupSelector = function (ev) {\r\n\t\t\t\tfillRGBFields(ev.data.cal.data('colorpicker').color, ev.data.cal.get(0));\r\n\t\t\t\tfillHexFields(ev.data.cal.data('colorpicker').color, ev.data.cal.get(0));\r\n\t\t\t\t$(document).unbind('mouseup', upSelector);\r\n\t\t\t\t$(document).unbind('mousemove', moveSelector);\r\n\t\t\t\treturn false;\r\n\t\t\t},\r\n\t\t\tenterSubmit = function (ev) {\r\n\t\t\t\t$(this).addClass('colorpicker_focus');\r\n\t\t\t},\r\n\t\t\tleaveSubmit = function (ev) {\r\n\t\t\t\t$(this).removeClass('colorpicker_focus');\r\n\t\t\t},\r\n\t\t\tclickSubmit = function (ev) {\r\n\t\t\t\tvar cal = $(this).parent();\r\n\t\t\t\tvar col = cal.data('colorpicker').color;\r\n\t\t\t\tcal.data('colorpicker').origColor = col;\r\n\t\t\t\tsetCurrentColor(col, cal.get(0));\r\n\t\t\t\tcal.data('colorpicker').onSubmit(col, HSBToHex(col), HSBToRGB(col), cal.data('colorpicker').el);\r\n\t\t\t},\r\n\t\t\tshow = function (ev) {\r\n\t\t\t\tvar cal = $('#' + $(this).data('colorpickerId'));\r\n\t\t\t\tcal.data('colorpicker').onBeforeShow.apply(this, [cal.get(0)]);\r\n\t\t\t\tvar pos = $(this).offset();\r\n\t\t\t\tvar viewPort = getViewport();\r\n\t\t\t\tvar top = pos.top + this.offsetHeight;\r\n\t\t\t\tvar left = pos.left;\r\n\t\t\t\tif (top + 176 > viewPort.t + viewPort.h) {\r\n\t\t\t\t\ttop -= this.offsetHeight + 176;\r\n\t\t\t\t}\r\n\t\t\t\tif (left + 356 > viewPort.l + viewPort.w) {\r\n\t\t\t\t\tleft -= 356;\r\n\t\t\t\t}\r\n\t\t\t\tcal.css({left: left + 'px', top: top + 'px'});\r\n\t\t\t\tif (cal.data('colorpicker').onShow.apply(this, [cal.get(0)]) != false) {\r\n\t\t\t\t\tcal.show();\r\n\t\t\t\t}\r\n\t\t\t\t$(document).bind('mousedown', {cal: cal}, hide);\r\n\t\t\t\treturn false;\r\n\t\t\t},\r\n\t\t\thide = function (ev) {\r\n\t\t\t\tif (!isChildOf(ev.data.cal.get(0), ev.target, ev.data.cal.get(0))) {\r\n\t\t\t\t\tif (ev.data.cal.data('colorpicker').onHide.apply(this, [ev.data.cal.get(0)]) != false) {\r\n\t\t\t\t\t\tev.data.cal.hide();\r\n\t\t\t\t\t}\r\n\t\t\t\t\t$(document).unbind('mousedown', hide);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tisChildOf = function(parentEl, el, container) {\r\n\t\t\t\tif (parentEl == el) {\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t\tif (parentEl.contains) {\r\n\t\t\t\t\treturn parentEl.contains(el);\r\n\t\t\t\t}\r\n\t\t\t\tif ( parentEl.compareDocumentPosition ) {\r\n\t\t\t\t\treturn !!(parentEl.compareDocumentPosition(el) & 16);\r\n\t\t\t\t}\r\n\t\t\t\tvar prEl = el.parentNode;\r\n\t\t\t\twhile(prEl && prEl != container) {\r\n\t\t\t\t\tif (prEl == parentEl)\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\tprEl = prEl.parentNode;\r\n\t\t\t\t}\r\n\t\t\t\treturn false;\r\n\t\t\t},\r\n\t\t\tgetViewport = function () {\r\n\t\t\t\tvar m = document.compatMode == 'CSS1Compat';\r\n\t\t\t\treturn {\r\n\t\t\t\t\tl : window.pageXOffset || (m ? document.documentElement.scrollLeft : document.body.scrollLeft),\r\n\t\t\t\t\tt : window.pageYOffset || (m ? document.documentElement.scrollTop : document.body.scrollTop),\r\n\t\t\t\t\tw : window.innerWidth || (m ? document.documentElement.clientWidth : document.body.clientWidth),\r\n\t\t\t\t\th : window.innerHeight || (m ? document.documentElement.clientHeight : document.body.clientHeight)\r\n\t\t\t\t};\r\n\t\t\t},\r\n\t\t\tfixHSB = function (hsb) {\r\n\t\t\t\treturn {\r\n\t\t\t\t\th: Math.min(360, Math.max(0, hsb.h)),\r\n\t\t\t\t\ts: Math.min(100, Math.max(0, hsb.s)),\r\n\t\t\t\t\tb: Math.min(100, Math.max(0, hsb.b))\r\n\t\t\t\t};\r\n\t\t\t}, \r\n\t\t\tfixRGB = function (rgb) {\r\n\t\t\t\treturn {\r\n\t\t\t\t\tr: Math.min(255, Math.max(0, rgb.r)),\r\n\t\t\t\t\tg: Math.min(255, Math.max(0, rgb.g)),\r\n\t\t\t\t\tb: Math.min(255, Math.max(0, rgb.b))\r\n\t\t\t\t};\r\n\t\t\t},\r\n\t\t\tfixHex = function (hex) {\r\n\t\t\t\tvar len = 6 - hex.length;\r\n\t\t\t\tif (len > 0) {\r\n\t\t\t\t\tvar o = [];\r\n\t\t\t\t\tfor (var i=0; i<len; i++) {\r\n\t\t\t\t\t\to.push('0');\r\n\t\t\t\t\t}\r\n\t\t\t\t\to.push(hex);\r\n\t\t\t\t\thex = o.join('');\r\n\t\t\t\t}\r\n\t\t\t\treturn hex;\r\n\t\t\t}, \r\n\t\t\tHexToRGB = function (hex) {\r\n\t\t\t\tvar hex = parseInt(((hex.indexOf('#') > -1) ? hex.substring(1) : hex), 16);\r\n\t\t\t\treturn {r: hex >> 16, g: (hex & 0x00FF00) >> 8, b: (hex & 0x0000FF)};\r\n\t\t\t},\r\n\t\t\tHexToHSB = function (hex) {\r\n\t\t\t\treturn RGBToHSB(HexToRGB(hex));\r\n\t\t\t},\r\n\t\t\tRGBToHSB = function (rgb) {\r\n\t\t\t\tvar hsb = {\r\n\t\t\t\t\th: 0,\r\n\t\t\t\t\ts: 0,\r\n\t\t\t\t\tb: 0\r\n\t\t\t\t};\r\n\t\t\t\tvar min = Math.min(rgb.r, rgb.g, rgb.b);\r\n\t\t\t\tvar max = Math.max(rgb.r, rgb.g, rgb.b);\r\n\t\t\t\tvar delta = max - min;\r\n\t\t\t\thsb.b = max;\r\n\t\t\t\tif (max != 0) {\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t\thsb.s = max != 0 ? 255 * delta / max : 0;\r\n\t\t\t\tif (hsb.s != 0) {\r\n\t\t\t\t\tif (rgb.r == max) {\r\n\t\t\t\t\t\thsb.h = (rgb.g - rgb.b) / delta;\r\n\t\t\t\t\t} else if (rgb.g == max) {\r\n\t\t\t\t\t\thsb.h = 2 + (rgb.b - rgb.r) / delta;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\thsb.h = 4 + (rgb.r - rgb.g) / delta;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\thsb.h = -1;\r\n\t\t\t\t}\r\n\t\t\t\thsb.h *= 60;\r\n\t\t\t\tif (hsb.h < 0) {\r\n\t\t\t\t\thsb.h += 360;\r\n\t\t\t\t}\r\n\t\t\t\thsb.s *= 100/255;\r\n\t\t\t\thsb.b *= 100/255;\r\n\t\t\t\treturn hsb;\r\n\t\t\t},\r\n\t\t\tHSBToRGB = function (hsb) {\r\n\t\t\t\tvar rgb = {};\r\n\t\t\t\tvar h = Math.round(hsb.h);\r\n\t\t\t\tvar s = Math.round(hsb.s*255/100);\r\n\t\t\t\tvar v = Math.round(hsb.b*255/100);\r\n\t\t\t\tif(s == 0) {\r\n\t\t\t\t\trgb.r = rgb.g = rgb.b = v;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tvar t1 = v;\r\n\t\t\t\t\tvar t2 = (255-s)*v/255;\r\n\t\t\t\t\tvar t3 = (t1-t2)*(h%60)/60;\r\n\t\t\t\t\tif(h==360) h = 0;\r\n\t\t\t\t\tif(h<60) {rgb.r=t1;\trgb.b=t2; rgb.g=t2+t3}\r\n\t\t\t\t\telse if(h<120) {rgb.g=t1; rgb.b=t2;\trgb.r=t1-t3}\r\n\t\t\t\t\telse if(h<180) {rgb.g=t1; rgb.r=t2;\trgb.b=t2+t3}\r\n\t\t\t\t\telse if(h<240) {rgb.b=t1; rgb.r=t2;\trgb.g=t1-t3}\r\n\t\t\t\t\telse if(h<300) {rgb.b=t1; rgb.g=t2;\trgb.r=t2+t3}\r\n\t\t\t\t\telse if(h<360) {rgb.r=t1; rgb.g=t2;\trgb.b=t1-t3}\r\n\t\t\t\t\telse {rgb.r=0; rgb.g=0;\trgb.b=0}\r\n\t\t\t\t}\r\n\t\t\t\treturn {r:Math.round(rgb.r), g:Math.round(rgb.g), b:Math.round(rgb.b)};\r\n\t\t\t},\r\n\t\t\tRGBToHex = function (rgb) {\r\n\t\t\t\tvar hex = [\r\n\t\t\t\t\trgb.r.toString(16),\r\n\t\t\t\t\trgb.g.toString(16),\r\n\t\t\t\t\trgb.b.toString(16)\r\n\t\t\t\t];\r\n\t\t\t\t$.each(hex, function (nr, val) {\r\n\t\t\t\t\tif (val.length == 1) {\r\n\t\t\t\t\t\thex[nr] = '0' + val;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\treturn hex.join('');\r\n\t\t\t},\r\n\t\t\tHSBToHex = function (hsb) {\r\n\t\t\t\treturn RGBToHex(HSBToRGB(hsb));\r\n\t\t\t},\r\n\t\t\trestoreOriginal = function () {\r\n\t\t\t\tvar cal = $(this).parent();\r\n\t\t\t\tvar col = cal.data('colorpicker').origColor;\r\n\t\t\t\tcal.data('colorpicker').color = col;\r\n\t\t\t\tfillRGBFields(col, cal.get(0));\r\n\t\t\t\tfillHexFields(col, cal.get(0));\r\n\t\t\t\tfillHSBFields(col, cal.get(0));\r\n\t\t\t\tsetSelector(col, cal.get(0));\r\n\t\t\t\tsetHue(col, cal.get(0));\r\n\t\t\t\tsetNewColor(col, cal.get(0));\r\n\t\t\t};\r\n\t\treturn {\r\n\t\t\tinit: function (opt) {\r\n\t\t\t\topt = $.extend({}, defaults, opt||{});\r\n\t\t\t\tif (typeof opt.color == 'string') {\r\n\t\t\t\t\topt.color = HexToHSB(opt.color);\r\n\t\t\t\t} else if (opt.color.r != undefined && opt.color.g != undefined && opt.color.b != undefined) {\r\n\t\t\t\t\topt.color = RGBToHSB(opt.color);\r\n\t\t\t\t} else if (opt.color.h != undefined && opt.color.s != undefined && opt.color.b != undefined) {\r\n\t\t\t\t\topt.color = fixHSB(opt.color);\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn this;\r\n\t\t\t\t}\r\n\t\t\t\treturn this.each(function () {\r\n\t\t\t\t\tif (!$(this).data('colorpickerId')) {\r\n\t\t\t\t\t\tvar options = $.extend({}, opt);\r\n\t\t\t\t\t\toptions.origColor = opt.color;\r\n\t\t\t\t\t\tvar id = 'collorpicker_' + parseInt(Math.random() * 1000);\r\n\t\t\t\t\t\t$(this).data('colorpickerId', id);\r\n\t\t\t\t\t\tvar cal = $(tpl).attr('id', id);\r\n\t\t\t\t\t\tif (options.flat) {\r\n\t\t\t\t\t\t\tcal.appendTo(this).show();\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tcal.appendTo(document.body);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\toptions.fields = cal\r\n\t\t\t\t\t\t\t\t\t\t\t.find('input')\r\n\t\t\t\t\t\t\t\t\t\t\t\t.bind('keyup', keyDown)\r\n\t\t\t\t\t\t\t\t\t\t\t\t.bind('change', change)\r\n\t\t\t\t\t\t\t\t\t\t\t\t.bind('blur', blur)\r\n\t\t\t\t\t\t\t\t\t\t\t\t.bind('focus', focus);\r\n\t\t\t\t\t\tcal\r\n\t\t\t\t\t\t\t.find('span').bind('mousedown', downIncrement).end()\r\n\t\t\t\t\t\t\t.find('>div.colorpicker_current_color').bind('click', restoreOriginal);\r\n\t\t\t\t\t\toptions.selector = cal.find('div.colorpicker_color').bind('mousedown', downSelector);\r\n\t\t\t\t\t\t//options.selectorIndic = options.selector.find('div div');\r\n\t\t\t\t\t\toptions.selectorIndic = cal.find('div.colorpicker_color div div'); // modified by lwf\r\n\t\t\t\t\t\toptions.el = this;\r\n\t\t\t\t\t\toptions.hue = cal.find('div.colorpicker_hue div');\r\n\t\t\t\t\t\tcal.find('div.colorpicker_hue').bind('mousedown', downHue);\r\n\t\t\t\t\t\toptions.newColor = cal.find('div.colorpicker_new_color');\r\n\t\t\t\t\t\toptions.currentColor = cal.find('div.colorpicker_current_color');\r\n\t\t\t\t\t\tcal.data('colorpicker', options);\r\n\t\t\t\t\t\tcal.find('div.colorpicker_submit')\r\n\t\t\t\t\t\t\t.bind('mouseenter', enterSubmit)\r\n\t\t\t\t\t\t\t.bind('mouseleave', leaveSubmit)\r\n\t\t\t\t\t\t\t.bind('click', clickSubmit);\r\n\t\t\t\t\t\tfillRGBFields(options.color, cal.get(0));\r\n\t\t\t\t\t\tfillHSBFields(options.color, cal.get(0));\r\n\t\t\t\t\t\tfillHexFields(options.color, cal.get(0));\r\n\t\t\t\t\t\tsetHue(options.color, cal.get(0));\r\n\t\t\t\t\t\tsetSelector(options.color, cal.get(0));\r\n\t\t\t\t\t\tsetCurrentColor(options.color, cal.get(0));\r\n\t\t\t\t\t\tsetNewColor(options.color, cal.get(0));\r\n\t\t\t\t\t\tif (options.flat) {\r\n\t\t\t\t\t\t\tcal.css({\r\n\t\t\t\t\t\t\t\tposition: 'relative',\r\n\t\t\t\t\t\t\t\tdisplay: 'block'\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t$(this).bind(options.eventName, show);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tshowPicker: function() {\r\n\t\t\t\treturn this.each( function () {\r\n\t\t\t\t\tif ($(this).data('colorpickerId')) {\r\n\t\t\t\t\t\tshow.apply(this);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\thidePicker: function() {\r\n\t\t\t\treturn this.each( function () {\r\n\t\t\t\t\tif ($(this).data('colorpickerId')) {\r\n\t\t\t\t\t\t$('#' + $(this).data('colorpickerId')).hide();\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tsetColor: function(col) {\r\n\t\t\t\tif (typeof col == 'string') {\r\n\t\t\t\t\tcol = HexToHSB(col);\r\n\t\t\t\t} else if (col.r != undefined && col.g != undefined && col.b != undefined) {\r\n\t\t\t\t\tcol = RGBToHSB(col);\r\n\t\t\t\t} else if (col.h != undefined && col.s != undefined && col.b != undefined) {\r\n\t\t\t\t\tcol = fixHSB(col);\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn this;\r\n\t\t\t\t}\r\n\t\t\t\treturn this.each(function(){\r\n\t\t\t\t\tif ($(this).data('colorpickerId')) {\r\n\t\t\t\t\t\tvar cal = $('#' + $(this).data('colorpickerId'));\r\n\t\t\t\t\t\tcal.data('colorpicker').color = col;\r\n\t\t\t\t\t\tcal.data('colorpicker').origColor = col;\r\n\t\t\t\t\t\tfillRGBFields(col, cal.get(0));\r\n\t\t\t\t\t\tfillHSBFields(col, cal.get(0));\r\n\t\t\t\t\t\tfillHexFields(col, cal.get(0));\r\n\t\t\t\t\t\tsetHue(col, cal.get(0));\r\n\t\t\t\t\t\tsetSelector(col, cal.get(0));\r\n\t\t\t\t\t\tsetCurrentColor(col, cal.get(0));\r\n\t\t\t\t\t\tsetNewColor(col, cal.get(0));\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t};\r\n\t}();\r\n\t$.fn.extend({\r\n\t\tColorPicker: ColorPicker.init,\r\n\t\tColorPickerHide: ColorPicker.hidePicker,\r\n\t\tColorPickerShow: ColorPicker.showPicker,\r\n\t\tColorPickerSetColor: ColorPicker.setColor\r\n\t});\r\n\treturn $;\r\n});"]}